import"./CPkq-MRm.js";import{c as h,r as u,s as S,t as W,f as le,p as V,g as s,u as d,a as Y,a0 as ce}from"./BX4Dnpro.js";import{f as A,g as X,s as O,a as x,c as de,d as ve}from"./DS607QHn.js";import{a as D,e as ue,c as he,b as H,i as fe}from"./Dbls2O6t.js";import{i as G}from"./DrMRszh9.js";import{p as K}from"./DQsDk8MY.js";import{g as pe}from"./6BIzYspF.js";import{g as we,B as N,e as me,p as ge}from"./CJIe8Wgg.js";import"./z-ijcZsT.js";import{C as J}from"./CzBRMrWk.js";import{W as be}from"./CGrgT5Uy.js";import{A as C,f as Q,e as xe,h as ye,p as _e,w as Ie,s as Se}from"./BegIwIKf.js";import{B as Z,d as Ae,c as Ee,h as je,E as Re}from"./BaqqN2bF.js";import{r as k}from"./C5U-6dPW.js";import{i as U,q as Pe,m as Be}from"./BJQ2FMEW.js";import{i as w}from"./CG1L1sNd.js";import{r as $,i as Ce}from"./CqzONN-w.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};e.SENTRY_RELEASE={id:"22f298fe9ac7c9892685cfa634f1dd18037bb1ae"}}catch{}})();try{(function(){var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="2db657a1-6c53-4d22-8a8b-938908e6d550",e._sentryDebugIdIdentifier="sentry-dbid-2db657a1-6c53-4d22-8a8b-938908e6d550")})()}catch{}var ke=A('<div class="flexrow-item svelte-j8h0c"><p class="text-12 flexrow-item__title svelte-j8h0c"> </p> <div class="text-12 flexrow-item__content svelte-j8h0c"><!></div> <p class="text-12 truncate flexrow-item__placeholder svelte-j8h0c"> </p></div>');const Te={hash:"svelte-j8h0c",code:`.flexrow-item.svelte-j8h0c {display:flex;flex-direction:column;gap:8px;}.flexrow-item__title.svelte-j8h0c {color:var(--clr-text-2);}.flexrow-item__content.svelte-j8h0c {display:flex;gap:8px;}

	/* Show placeholder if empty */.flexrow-item__content.svelte-j8h0c:empty {display:none;}.flexrow-item__content.svelte-j8h0c:empty + .flexrow-item__placeholder:where(.svelte-j8h0c) {display:block;}.flexrow-item__placeholder.svelte-j8h0c {display:none;color:var(--clr-text-3);}`};function ut(e,t){D(e,Te);var r=ke(),a=h(r),n=h(a);u(a);var i=S(a,2),c=h(i);X(c,()=>t.children),u(i);var l=S(i,2),p=h(l,!0);u(l),u(r),W(()=>{O(n,`${t.label??""}:`),O(p,t.placeholderText)}),x(e,r)}var ze=A('<div class="info-flex-row svelte-110n0ws"><!></div>');const Le={hash:"svelte-110n0ws",code:`.info-flex-row.svelte-110n0ws {container:info-flex-row;display:flex;flex-wrap:wrap;gap:16px 30px;

		/* TODO: Add container query here. It doesn't work in the current version of Svelte. */
		/* display: grid;
		grid-template-columns: repeat(auto-fill, minmax(74px, 1fr));
		grid-auto-flow: row dense;
		grid-gap: 16px 30px; */}`};function ht(e,t){D(e,Le);var r=ze(),a=h(r);{var n=i=>{var c=de(),l=le(c);X(l,()=>t.children),x(i,c)};G(a,i=>{t.children&&i(n)})}u(r),x(e,r)}function We(e,t){V(t,!0);const r=d(()=>we(t.patchCommit));J(e,{get status(){return s(r)}}),Y()}function ft(e,t,r=N.All,a){const n=w(C),c=w(Z).getBranchesInterest(e,t,r);k(c,a);const l=d(()=>xe.selectors.selectById(n.branchReviewListings,me(e,t,r))),p=d(()=>{if(!U(s(l)))return s(l);const y=new Map;return s(l).value.forEach(E=>{const b=Q.selectors.selectById(n.branches,E);if(!U(b)||b.value.status===N.Previous)return;const j=b.value,m=y.get(j.stackId)||[];m.push(j),m.sort((z,o)=>o.stackOrder-z.stackOrder),y.set(j.stackId,m)}),{value:[...y.values()].sort((E,b)=>new Date(b[0].updatedAt).getTime()-new Date(E[0].updatedAt).getTime()),status:"found"}});return{get current(){return s(p)}}}function Oe(e,t){const r=w(Z),a=w(C),n=r.getBranchInterest(e);k(n,t);const i=d(()=>Q.selectors.selectById(a.branches,e));return{get current(){return s(i)}}}function Ue(e,t,r,a){const n=w(C),c=w(Ae).getPatchIdableInterest({branchUuid:e,changeId:t,oldVersion:r,newVersion:a});k(c);const l=ge({branchUuid:e,changeId:t,oldVersion:r,newVersion:a}),p=d(()=>ye.selectors.selectById(n.patchIdables,l));return $(()=>s(p))}function De(e,t,r){const a=w(Ee),n=w(C),i=a.getPatchWithSectionsInterest(e,t);k(i,r);const c=d(()=>_e.selectors.selectById(n.patches,t));return{get current(){return s(c)}}}function pt(e,t,r,a){const n=w(C),i=Ue(e,t,r,a),c=d(()=>Pe(i.current,l=>(l.sectionIds||[]).map(p=>Ie.selectById(n.patchSections,p)).filter(p=>p)));return{get current(){return s(c)}}}function wt(e,t,r,a,n){const i=t.patchEventsInterest(r,a);k(i,n);const c=je(r,a),l=d(()=>Se.selectById(e.patchEvents,c));return{get current(){return s(l)}}}var Fe=A('<div class="info-section bottom svelte-wa58l9"><div class="section-header svelte-wa58l9"><p class="text-11">Your status:</p></div> <!></div>'),qe=A('<div class="info-card svelte-wa58l9"><div class="info-section svelte-wa58l9"><div class="section-header svelte-wa58l9"><!> <p class="text-11"> </p></div> <p class="text-13 text-semibold no-wrap svelte-wa58l9"> </p></div> <!></div>'),Me=(e,t,r)=>t(s(r)),He=A('<div class="erectangle-hover-area svelte-wa58l9"><div role="presentation"><!></div></div>'),Ke=A("<div></div>");const Ne={hash:"svelte-wa58l9",code:".minimap.svelte-wa58l9 {display:flex;gap:0.0625rem;}.minimap.horizontal.svelte-wa58l9 {position:relative;top:auto;flex-direction:row-reverse;justify-content:flex-end;width:100%;}.minimap.horizontal.svelte-wa58l9 .erectangle-hover-area:where(.svelte-wa58l9) {flex:1;width:auto;max-width:0.75rem;}.minimap.horizontal.svelte-wa58l9 .erectangle:where(.svelte-wa58l9) {width:100%;height:0.75rem;border-radius:var(--radius-s);}.minimap.horizontal.svelte-wa58l9 .erectangle-hover-area:where(.svelte-wa58l9):hover .info-card:where(.svelte-wa58l9) {display:flex;position:absolute;top:unset;top:1.125rem;left:0;}.minimap.horizontal.no-stretch.svelte-wa58l9 {width:auto;}.minimap.horizontal.no-stretch.svelte-wa58l9 .erectangle-hover-area:where(.svelte-wa58l9) {flex:none;width:0.75rem;}.minimap.svelte-wa58l9:not(.horizontal) {z-index:var(--z-lifted);position:fixed;top:6.25rem;left:0;flex-direction:column;}.minimap.svelte-wa58l9:not(.horizontal) .erectangle-hover-area:where(.svelte-wa58l9):hover {z-index:var(--z-lifted);}.minimap.svelte-wa58l9:not(.horizontal) .erectangle-hover-area:where(.svelte-wa58l9):hover .erectangle:where(.svelte-wa58l9) {width:100%;}.minimap.svelte-wa58l9:not(.horizontal) .erectangle-hover-area:where(.svelte-wa58l9):hover .info-card:where(.svelte-wa58l9) {display:flex;position:absolute;}.erectangle-hover-area.svelte-wa58l9 {display:flex;position:relative;width:1.875rem;}.erectangle.svelte-wa58l9 {width:0.625rem;height:1rem;background-color:var(--clr-core-gray-70);cursor:pointer;transition:width var(--transition-medium);}.erectangle.is-subject.svelte-wa58l9 {cursor:default;}.info-card.svelte-wa58l9 {display:none;z-index:var(--z-lifted);top:-1.25rem;left:2.1875rem;flex-direction:column;width:13rem;border:0.0625rem solid var(--clr-border-2);border-radius:var(--radius-m);background-color:var(--clr-bg-1);transition:none;}.info-section.svelte-wa58l9 {display:flex;flex-direction:column;padding:0.75rem;gap:0.5rem;}.info-section.bottom.svelte-wa58l9 {border-top:0.0625rem solid var(--clr-border-2);}.section-header.svelte-wa58l9 {display:flex;align-items:center;gap:0.5rem;color:var(--clr-text-2);}.no-wrap.svelte-wa58l9 {overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}.changes-requested.svelte-wa58l9 {background-color:var(--clr-br-commit-changes-requested-bg);}.approved.svelte-wa58l9 {background-color:var(--clr-br-commit-approved-bg);}.in-discussion.svelte-wa58l9 {background-color:var(--clr-br-commit-in-discussion-bg);}"};function mt(e,t){V(t,!0),D(e,Ne);const r=(o,v=ce)=>{const g=d(()=>v().reviewAll.rejected.find(f=>f.id===t.user.id)),_=d(()=>v().reviewAll.signedOff.find(f=>f.id===t.user.id)),L=d(()=>v().contributors.some(f=>{var I;return f.email===t.user.email||((I=f.user)==null?void 0:I.id)===t.user.id}));var R=qe(),P=h(R),B=h(P),F=h(B);We(F,{get patchCommit(){return v()}});var q=S(F,2),re=h(q);u(q),u(B);var M=S(B,2),ae=h(M,!0);u(M),u(P);var ne=S(P,2);{var se=f=>{var I=Fe(),ie=S(h(I),2);{let oe=d(()=>s(_)?"approved":s(g)?"changes-requested":"unreviewed");J(ie,{get status(){return s(oe)}})}u(I),x(f,I)};G(ne,f=>{s(L)||f(se)})}u(R),W(f=>{O(re,`Change: ${f??""}`),O(ae,v().title)},[()=>v().changeId.slice(0,7)]),x(o,R)},a=K(t,"horizontal",3,!1),n=K(t,"openExternally",3,!1),i=w(be),c=w(Re),l=d(()=>Oe(t.branchUuid)),p=d(()=>Be(s(l).current,o=>o.patchCommitIds.map(v=>De(o.uuid,v)))||[]),y=d(()=>s(p).map(o=>{if(U(o.current))return o.current.value}).filter(Ce));function E(o){if(o.commentCount>0&&o.reviewAll.signedOff.length===0&&o.reviewAll.rejected.length===0)return"in-discussion";if(o.reviewAll.rejected.length>0)return"changes-requested";if(o.reviewAll.signedOff.length>0)return"approved"}function b(o){const v=d(()=>{var g;return((g=i.isProjectReviewBranchCommitPageSubset)==null?void 0:g.changeId)===o});return $(()=>s(v))}function j(o){U(s(l).current)&&(n()?c.open(i.projectReviewBranchCommitUrl({ownerSlug:t.ownerSlug,projectSlug:t.projectSlug,branchId:s(l).current.value.branchId,changeId:o.changeId})):pe(i.projectReviewBranchCommitPath({ownerSlug:t.ownerSlug,projectSlug:t.projectSlug,branchId:s(l).current.value.branchId,changeId:o.changeId})))}var m=Ke();let z;ue(m,21,()=>s(y)??[],fe,(o,v)=>{var g=He(),_=h(g);let L;_.__click=[Me,j,v];var R=h(_);r(R,()=>s(v)),u(_),u(g),W((P,B)=>L=H(_,1,P,"svelte-wa58l9",L,B),[()=>he(["erectangle",E(s(v))]),()=>({"is-subject":b(s(v).changeId).current})]),x(o,g)}),u(m),W(o=>z=H(m,1,"minimap svelte-wa58l9",null,z,o),[()=>({horizontal:a(),"no-stretch":s(y).length<=5})]),x(e,m),Y()}ve(["click"]);function gt(e,t){const r=new Set,a=[];for(const n of e){const i=n[t];r.has(i)||(r.add(i),a.push(n))}return a}function Ve(e,t){const r=[],a=[];for(const n of e){if(t(n)){a.push(n);continue}r.push(n)}return[a,r]}function Ye(e){if(e)return`https://www.gravatar.com/avatar/${e}?s=100&r=g&d=retro`}async function ee(e){const t=new TextEncoder,r=(e||"").toLocaleLowerCase().replaceAll(" ",""),a=t.encode(r),n=await crypto.subtle.digest("SHA-256",a),c=Array.from(new Uint8Array(n)).map(l=>l.toString(16).padStart(2,"0")).join("");return Ye(c)}async function Xe(e){return await Promise.all(e.map(async t=>({srcUrl:await ee(t),username:t})))}async function T(e){return await Promise.all(e.map(async t=>{const r=t.login??t.email??t.name??"unknown",a=t.email??"unknown";return{srcUrl:t.avatarUrl??await ee(a),username:r}}))}async function te(e){const[t,r]=Ve(e,a=>!!a.user);return await Promise.all([T(t.map(a=>a.user)),Xe(r.map(a=>a.email))]).then(a=>a.flat())}async function bt(e){return await te(e.contributors)}async function xt(e){return await te(e.contributors)}async function yt(e){return await T(e.review.signedOff)}async function _t(e){return await T(e.reviewAll.signedOff)}async function It(e){return await T(e.review.rejected)}async function St(e){return await T(e.reviewAll.rejected)}export{We as C,ut as F,ht as I,mt as M,_t as a,St as b,De as c,Oe as d,bt as e,ft as f,xt as g,gt as h,wt as i,T as j,yt as k,It as l,pt as m};
//# sourceMappingURL=Dwaw39Uc.js.map
