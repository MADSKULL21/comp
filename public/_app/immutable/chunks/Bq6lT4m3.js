var h=Object.defineProperty;var u=(a,t,e)=>t in a?h(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e;var i=(a,t,e)=>u(a,typeof t!="symbol"?t+"":t,e);import{a as l}from"./CJIe8Wgg.js";import{I as p,a as f,b as d,p as r,e as j}from"./BJQ2FMEW.js";import{u as y,a as P}from"./BegIwIKf.js";import{b as c}from"./COwXhGw8.js";import{I as b}from"./CG1L1sNd.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};a.SENTRY_RELEASE={id:"22f298fe9ac7c9892685cfa634f1dd18037bb1ae"}}catch{}})();try{(function(){var a=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new a.Error().stack;t&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[t]="1f67ef19-ed32-42a1-8db9-a7a0fe1204c1",a._sentryDebugIdIdentifier="sentry-dbid-1f67ef19-ed32-42a1-8db9-a7a0fe1204c1")})()}catch{}function g(a){return{slug:a.slug,name:a.name,description:a.description,readme:a.readme,share_level:a.shareLevel}}const O=new b("ProjectService");class v{constructor(t,e){i(this,"httpClient");i(this,"appDispatch");i(this,"projectInterests",new p(f));i(this,"userProjectsInterests",new p(d));i(this,"recentProjectsInterests",new p(d));i(this,"recentlyPushedProjectsInterests",new p(d));this.httpClient=t,this.appDispatch=e}getProjectInterest(t){return this.projectInterests.findOrCreateSubscribable({repositoryId:t},async()=>{this.appDispatch.dispatch(r.addOne({status:"loading",id:t}));try{const e=await this.httpClient.get(`projects/${t}`);this.appDispatch.dispatch(r.upsertOne({status:"found",id:t,value:c(e)}))}catch(e){this.appDispatch.dispatch(r.addOne(j(e,t)))}}).createInterest()}async getProject(t){try{const e=await this.httpClient.get(`projects/${t}`);return this.appDispatch.dispatch(r.upsertOne({status:"found",id:t,value:c(e)})),c(e)}catch{}}async getProjectBySlug(t){try{const e=await this.httpClient.get(`projects/full/${t}`);return this.appDispatch.dispatch(r.upsertOne({status:"found",id:e.repository_id,value:c(e)})),c(e)}catch{}}async getProjectPatchStacks(t){try{return(await this.httpClient.get(`patch_stack/${t}`)).map(l)}catch(e){return console.error(`Error fetching patch stacks for ${t}:`,e),[]}}getAllProjectsInterest(){return this.userProjectsInterests.findOrCreateSubscribable({unused:"unused"},async()=>{const e=(await this.httpClient.get("projects")).map(s=>({status:"found",id:s.repository_id,value:c(s)}));this.appDispatch.dispatch(r.upsertMany(e))}).createInterest()}getRecentProjectsInterest(){return this.recentProjectsInterests.findOrCreateSubscribable({unused:"unused"},async()=>{const e=(await this.httpClient.get("projects/recently_interacted")).map(s=>({status:"found",id:s.repository_id,value:c(s)}));this.appDispatch.dispatch(r.upsertMany(e)),this.appDispatch.dispatch(y(e.map(s=>s.id)))}).createInterest()}getRecentlyPushedProjectsInterest(){return this.recentlyPushedProjectsInterests.findOrCreateSubscribable({unused:"unused"},async()=>{const e=(await this.httpClient.get("projects/recently_pushed")).map(s=>({status:"found",id:s.repository_id,value:c(s)}));this.appDispatch.dispatch(r.upsertMany(e)),this.appDispatch.dispatch(P(e.map(s=>s.id)))}).createInterest()}async createProject(t,e){const s=await this.httpClient.post("projects",{body:{name:t,description:e}}),n=c(s);return this.appDispatch.dispatch(r.upsertOne({status:"found",id:n.repositoryId,value:n})),n}async connectProjectToOrganization(t,e,s){const n=await this.httpClient.post(`projects/${t}/connect`,{body:{organization_slug:e,project_slug:s}}),o=c(n);return this.appDispatch.dispatch(r.upsertOne({status:"found",id:o.repositoryId,value:o})),o}async deleteProject(t){await this.httpClient.delete(`projects/${t}`),this.appDispatch.dispatch(r.removeOne(t))}async updateProject(t,e){const s=await this.httpClient.patch(`projects/${t}`,{body:g(e)}),n=c(s);return this.appDispatch.dispatch(r.upsertOne({status:"found",id:n.repositoryId,value:n})),n}async disconnectProject(t){const e=await this.httpClient.post(`projects/${t}/disconnect`),s=c(e);return this.appDispatch.dispatch(r.upsertOne({status:"found",id:s.repositoryId,value:s})),s}}export{O as P,v as a};
//# sourceMappingURL=Bq6lT4m3.js.map
