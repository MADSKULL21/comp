var o=Object.defineProperty;var p=(t,e,a)=>e in t?o(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a;var i=(t,e,a)=>p(t,typeof e!="symbol"?e+"":e,a);import{l as c}from"./BegIwIKf.js";import{a as d}from"./CJIe8Wgg.js";import{I as u,a as h,e as l}from"./BJQ2FMEW.js";import{I as r}from"./CG1L1sNd.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"22f298fe9ac7c9892685cfa634f1dd18037bb1ae"}}catch{}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new t.Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="07edcc73-21c8-4c39-8ac3-5b5ce2cb0734",t._sentryDebugIdIdentifier="sentry-dbid-07edcc73-21c8-4c39-8ac3-5b5ce2cb0734")})()}catch{}const m=new r("LatestBranchLookupService");class T{constructor(e,a){i(this,"httpClient");i(this,"appDispatch");i(this,"branchLookupInterests",new u(h));this.httpClient=e,this.appDispatch=a}getBranchUuidInterest(e,a,n){return this.branchLookupInterests.findOrCreateSubscribable({branchId:n},async()=>{this.appDispatch.dispatch(c.addOne({status:"loading",id:n}));try{const s=await this.httpClient.get(`patch_stack/${e}/${a}/branch/${n}`);this.appDispatch.dispatch(c.upsertOne({status:"found",id:n,value:s.uuid}))}catch(s){this.appDispatch.dispatch(c.addOne(l(s,n)))}}).createInterest()}async getBranch(e,a,n){try{const s=await this.httpClient.get(`patch_stack/${e}/${a}/branch/${n}`);return this.appDispatch.dispatch(c.upsertOne({status:"found",id:n,value:s.uuid})),d(s)}catch{}}async refreshBranchUuid(e){await this.branchLookupInterests.invalidate({branchId:e})}}function f(t){return t.startsWith("image/")}function b(t){return{uuid:t.uuid,filename:t.filename,contentType:t.content_type,url:t.url,public:t.public,createdAt:t.created_at,isImage:f(t.content_type)}}const y=10*1024*1024,D=new r("UploadsService");class E{constructor(e){i(this,"httpClient");this.httpClient=e}async uploadFile(e){if(e.size>y)return await Promise.reject("File size limit exceeded");const a=new FormData;a.append("file",e),a.append("public","true");const n=await this.httpClient.post("uploads",{body:a,headers:{"Content-Type":void 0}});return b(n)}}export{m as L,D as U,T as a,E as b};
//# sourceMappingURL=CWb7VjCc.js.map
