import{a as te,s as re}from"../chunks/CPkq-MRm.js";import{p as oe,V as se,g as e,u as i,a as ae,$ as ne,s as d,c as ie,Q as c,n as m,r as le,b as n,t as D}from"../chunks/BX4Dnpro.js";import{b as fe,f as P,t as z,a as p,e as ce,s as L}from"../chunks/DS607QHn.js";import{i as x}from"../chunks/DrMRszh9.js";import{a as ue}from"../chunks/Dbls2O6t.js";import{b as B}from"../chunks/DQsDk8MY.js";import{g as de}from"../chunks/6BIzYspF.js";import{n as me,U as pe}from"../chunks/g_ZEKDZH.js";import{F as ve}from"../chunks/DWPnRHGd.js";import{U as be}from"../chunks/D69wT3hA.js";import{i as U}from"../chunks/CG1L1sNd.js";import{L as ge}from"../chunks/BoCk19Um.js";import{W as _e}from"../chunks/CGrgT5Uy.js";import{B as ye}from"../chunks/z-ijcZsT.js";import{I as C}from"../chunks/CvJxvGJn.js";import{E as xe}from"../chunks/CxtGeu4p.js";(function(){try{var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};s.SENTRY_RELEASE={id:"22f298fe9ac7c9892685cfa634f1dd18037bb1ae"}}catch{}})();try{(function(){var s=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},u=new s.Error().stack;u&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[u]="7722386f-d1bd-4cb3-99c6-906b56dba465",s._sentryDebugIdIdentifier="sentry-dbid-7722386f-d1bd-4cb3-99c6-906b56dba465")})()}catch{}var $e=P("Almost <i>done</i>!",1),Ee=P('<form class="finalize-form__content svelte-r9kjr7"><p class="text-12 text-base finalize-form__caption svelte-r9kjr7">We need these details to set up your account properly.</p> <!> <!> <!> <!> <!></form>');const he={hash:"svelte-r9kjr7",code:".finalize-form__content.svelte-r9kjr7 {display:flex;flex-direction:column;gap:16px;}.finalize-form__caption.svelte-r9kjr7 {margin-top:-20px;margin-bottom:8px;color:var(--clr-text-2);}"};function Pe(s,u){oe(u,!0),ue(s,he);const[M,O]=te(),v=()=>re(G,"$user",M),j=U(be),W=U(ge),q=U(_e),G=j.user,N=i(()=>v()!==void 0),$=i(()=>{var r;return(r=v())==null?void 0:r.email}),E=i(()=>{var r;return(r=v())==null?void 0:r.login}),Y=i(()=>e(N)&&e($)&&e(E));let b=c(void 0),g=c(void 0),h=c(void 0),w=c(void 0),l=c(void 0),I=c(void 0);const S=i(()=>e(b)??e($)),T=i(()=>e(g)??e(E)),Q=i(()=>{var r,o;return!!e(S)&&!!e(T)&&(!e(b)||((r=e(h))==null?void 0:r.isValid()))&&(!e(g)||((o=e(w))==null?void 0:o.isValid()))});async function H(r){if(r.preventDefault(),!v()){n(l,"You must be logged in to finalize your account.");return}if(!e(S)){n(l,"Email is required.");return}if(!e(T)){n(l,"Username is required.");return}const o=await W.finalizeAccount(e(S),e(T));if(o.type==="error"){n(l,o.errorMessage,!0),console.error("Finalize account failed:",o.raw??o.errorMessage);return}n(l,void 0),n(I,o.data.message,!0),await j.refreshUser()}se(()=>{if(e(Y)){const r=setTimeout(()=>{de(q.profilePath())},3e3);return()=>clearTimeout(r)}}),fe(r=>{ne.title="GitButler | Finalize Account"}),ve(s,{get illustration(){return me},title:o=>{m();var k=$e();m(2),p(o,k)},children:(o,k)=>{var _=Ee(),R=d(ie(_),2);{var J=t=>{B(pe(t,{get value(){return e(g)},set value(a){n(g,a,!0)}}),a=>n(w,a,!0),()=>e(w))};x(R,t=>{e(E)||t(J)})}var F=d(R,2);{var K=t=>{B(xe(t,{label:"Email",get value(){return e(b)},set value(a){n(b,a,!0)}}),a=>n(h,a,!0),()=>e(h))};x(F,t=>{e($)||t(K)})}var V=d(F,2);{var X=t=>{C(t,{filled:!0,outlined:!1,style:"danger",content:y=>{m();var f=z();D(()=>L(f,e(l))),p(y,f)},$$slots:{content:!0}})};x(V,t=>{e(l)&&t(X)})}var A=d(V,2);{var Z=t=>{C(t,{filled:!0,outlined:!1,style:"success",content:y=>{m();var f=z();D(()=>L(f,e(I))),p(y,f)},$$slots:{content:!0}})};x(A,t=>{e(I)&&t(Z)})}var ee=d(A,2);{let t=i(()=>!e(Q));ye(ee,{style:"pop",type:"submit",get disabled(){return e(t)},children:(a,y)=>{m();var f=z("Finalize Account");p(a,f)},$$slots:{default:!0}})}le(_),ce("submit",_,H),p(o,_)}}),ae(),O()}export{Pe as component};
//# sourceMappingURL=19.YQpbEDRp.js.map
