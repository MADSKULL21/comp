var ge=Object.defineProperty;var Se=(t,e,s)=>e in t?ge(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var I=(t,e,s)=>Se(t,typeof e!="symbol"?e+"":e,s);import{a as F,s as q}from"../chunks/CPkq-MRm.js";import{p as H,a as W,c as B,g as c,r as T,Q as _e,a8 as ye,V as re,u,b as Ee,as as we,f as Ie,s as b,a0 as Ce}from"../chunks/BX4Dnpro.js";import{f as P,a as D,g as be}from"../chunks/DS607QHn.js";import{a as G,e as Re}from"../chunks/Dbls2O6t.js";/* empty css                */import{p as E}from"../chunks/RIzBnn02.js";import{U as Te,P as De,C as Pe,N as xe,B as $e,a as Le,b as Ae,c as Oe,d as Ne}from"../chunks/DVpAvUUN.js";import{a as ke,g as ze}from"../chunks/6BIzYspF.js";import{U as ie,a as Ue}from"../chunks/D69wT3hA.js";import{i as J,I as je,p as i}from"../chunks/CG1L1sNd.js";import{W as Ve}from"../chunks/CGrgT5Uy.js";import{O as Be,a as Fe}from"../chunks/CJBytYAq.js";import{a as qe,W as He}from"../chunks/BfntTFd4.js";import{N as We,a as Ge,S as Me,b as Ke}from"../chunks/CuBQQk68.js";import{a as Ye,P as Ze,b as Je,B as Xe,c as Qe,d as et,E as tt}from"../chunks/BaqqN2bF.js";import{a as at,L as st,b as rt,U as it}from"../chunks/CWb7VjCc.js";import{i as X,j as Q,k as nt,m as ot,o as ct,A as pt}from"../chunks/BegIwIKf.js";import{I as ee,a as lt,k as dt,l as ut}from"../chunks/BJQ2FMEW.js";import{h as te}from"../chunks/CJIe8Wgg.js";import{a as ft,L as ht}from"../chunks/BoCk19Um.js";import{a as mt,H as vt}from"../chunks/B-2PMw0t.js";import{a as gt,O as St}from"../chunks/vdW0E3mk.js";import{a as _t,P as yt}from"../chunks/Bq6lT4m3.js";import{a as Et,R as wt}from"../chunks/CEeq9kCl.js";import{a as It,R as Ct}from"../chunks/BysAMWPW.js";import{i as bt,c as ae,j as Rt,k as Tt}from"../chunks/z-ijcZsT.js";import{i as Dt}from"../chunks/DEetUlE7.js";import{e as se}from"../chunks/GxSCJhZN.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"22f298fe9ac7c9892685cfa634f1dd18037bb1ae"}}catch{}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new t.Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="2dd2772c-6586-4dd8-95b6-74bf00a643bf",t._sentryDebugIdIdentifier="sentry-dbid-2dd2772c-6586-4dd8-95b6-74bf00a643bf")})()}catch{}function Pt(t,{from:e,to:s},l={}){var{delay:n=0,duration:p=_=>Math.sqrt(_)*120,easing:r=bt}=l,a=getComputedStyle(t),d=a.transform==="none"?"":a.transform,[h,m]=a.transformOrigin.split(" ").map(parseFloat);h/=t.clientWidth,m/=t.clientHeight;var o=xt(t),g=t.clientWidth/s.width/o,f=t.clientHeight/s.height/o,S=e.left+e.width*h,x=e.top+e.height*m,$=s.left+s.width*h,C=s.top+s.height*m,v=(S-$)*g,w=(x-C)*f,L=e.width/s.width,A=e.height/s.height;return{delay:n,duration:typeof p=="function"?p(Math.sqrt(v*v+w*w)):p,easing:r,css:(_,y)=>{var O=y*v,N=y*w,k=_+y*L,z=_+y*A;return`transform: ${d} translate(${O}px, ${N}px) scale(${k}, ${z});`}}}function xt(t){if("currentCSSZoom"in t)return t.currentCSSZoom;for(var e=t,s=1;e!==null;)s*=+getComputedStyle(e).zoom,e=e.parentElement;return s}var $t=P('<div class="svelte-186lum5"><!></div>'),Lt=P('<div class="chip-toast-container svelte-186lum5"></div>');const At={hash:"svelte-186lum5",code:".chip-toast-container.svelte-186lum5{align-items:center;bottom:1.25rem;display:flex;flex-direction:column;gap:.5rem;left:50%;pointer-events:none;position:fixed;transform:translateX(-50%);z-index:9999}.chip-toast-container.svelte-186lum5>:where(.svelte-186lum5){pointer-events:auto}"};function Ot(t,e){H(e,!1),G(t,At);const[s,l]=F(),n=()=>q(ae,"$chipToasts",s);Dt();var p=Lt();Re(p,13,n,r=>r.id,(r,a)=>{var d=$t(),h=B(d);Rt(h,{get message(){return c(a).message},get type(){return c(a).type},get customButton(){return c(a).customButton},get showDismiss(){return c(a).showDismiss},onDismiss:()=>ae.removeChipToast(c(a).id)}),T(d),Tt(d,()=>Pt,()=>({duration:200})),D(r,d)}),T(p),D(t,p),W(),l()}function Nt(t,e){H(e,!0);const[s,l]=F(),n=()=>q(a,"$user",s),p=J(Ve),a=J(ie).user,d=u(()=>{var f;return(f=n())==null?void 0:f.email}),h=u(()=>{var f;return(f=n())==null?void 0:f.login}),m=u(()=>n()!==void 0),o=u(()=>c(m)&&(!c(d)||!c(h)));let g=_e(ye(location.pathname));ke(f=>{var S;Ee(g,((S=f.to)==null?void 0:S.url.pathname)||"",!0)}),re(()=>{c(o)&&c(g)!==p.finalizeAccountPath()&&ze(p.finalizeAccountPath())}),W(),l()}var kt=P('<footer class="footer text-12 svelte-yj4z60"><span>GitButler © 2025</span> <div class="footer-links svelte-yj4z60"><a class="footer-link svelte-yj4z60" target="_blank" href="https://docs.gitbutler.com/">Docs ↗</a> <a class="footer-link svelte-yj4z60" target="_blank" href="https://discord.com/invite/MmFkmaJ42D">Discord ↗</a> <a class="footer-link svelte-yj4z60" href="/downloads">Downloads</a></div> <div class="footer-links svelte-yj4z60"><a class="footer-link underline svelte-yj4z60" href="/privacy" target="_blank">Privacy Policy</a> <span>|</span> <a class="footer-link underline svelte-yj4z60" href="/terms" target="_blank">Terms of Service</a></div></footer>');const zt={hash:"svelte-yj4z60",code:".footer.svelte-yj4z60 {display:flex;grid-column:full-start / full-end;flex-wrap:wrap;align-items:center;justify-content:flex-end;padding:20px 0 24px;gap:12px 24px;color:var(--clr-text-2);}.footer-links.svelte-yj4z60 {display:flex;align-items:center;gap:8px;}.footer-link.svelte-yj4z60 {display:flex;align-items:center;gap:2px;color:var(--clr-text-2);transition:color var(--transition-fast);}.footer-link.svelte-yj4z60:hover {color:var(--clr-text-1);}"};function Ut(t){G(t,zt);var e=kt();D(t,e)}function R(t){return{uuid:t.uuid,content:t.content,postType:t.post_type,replyToId:t.reply_to_id,createdAt:t.created_at,userLogin:t.user.login??"",pictureUrl:t.picture_url||void 0}}const jt=new je("FeedService");class Vt{constructor(e,s){I(this,"httpClient");I(this,"appDispatch");I(this,"feedInterests",new ee(lt));I(this,"postWithRepliesInterests",new ee(dt));this.httpClient=e,this.appDispatch=s}getFeedHeadInterest(e){return this.feedInterests.findOrCreateSubscribable({identifier:e},()=>{this.getFeedPage(e)}).createInterest()}async getFeedPage(e,s){const l=s?`?from_created_at=${s}`:"",n=await this.httpClient.get(`feed/project/${e}${l}`);this.appDispatch.dispatch(X(n.map(R)));const p=n.map(a=>({status:"found",value:te(a.user),id:a.user.id}));this.appDispatch.dispatch(Q.upsertMany(p));const r={identifier:e,postIds:n.map(a=>a.uuid)};s?this.appDispatch.dispatch(nt(r)):this.appDispatch.dispatch(ot(r))}async createPost(e,s,l,n,p){await ut(this.httpClient.authenticationAvailable);const r=new FormData;r.append("content",e),r.append("project_repository_id",s),n&&r.append("reply_to",n),p&&r.append("picture",p);const a=await this.httpClient.post("feed/new",{body:r,headers:{"Content-Type":void 0}}),d=R(a);return this.appDispatch.dispatch(ct(d)),n?this.getPostWithReplies(n):this.getFeedPage(l),d}getPostWithRepliesInterest(e){return this.postWithRepliesInterests.findOrCreateSubscribable({postId:e},async()=>{this.getPostWithReplies(e)}).createInterest()}async getPostWithReplies(e){const s=await this.httpClient.get(`feed/post/${e}`),l=R(s);l.replyIds=s.replies.map(r=>r.uuid);const n=[l,...s.replies.map(R)];this.appDispatch.dispatch(X(n));const p=[s,...s.replies].map(r=>({status:"found",id:r.user.id,value:te(r.user)}));this.appDispatch.dispatch(Q.upsertMany(p))}}var Bt=P('<!> <div class="app svelte-i67q8q"><!> <main class="svelte-i67q8q"><!></main> <!></div> <!>',1);const Ft={hash:"svelte-i67q8q",code:`.app.svelte-i67q8q {display:grid;grid-template-rows:auto 1fr auto;grid-template-columns:[full-start]
			repeat(2, 1fr)
			[narrow-start]
			repeat(8, 1fr)
			[narrow-end]
			1fr [off-center] 1fr
			[full-end];-moz-column-gap:var(--layout-col-gap);column-gap:var(--layout-col-gap);row-gap:24px;align-items:start;width:100%;max-width:calc(1440px + var(--layout-side-paddings) * 2);min-height:100dvh;margin:0 auto;padding:0 var(--layout-side-paddings);}

	@media (max-width: 80rem) {.app.svelte-i67q8q {grid-template-columns:[full-start]
				1fr
				[narrow-start]
				repeat(10, 1fr)
				[narrow-end off-center]
				1fr
				[full-end];}
		}

	@media (max-width: 46.25rem) {.app.svelte-i67q8q {grid-template-columns:[full-start narrow-start]
				repeat(4, 1fr)
				[narrow-end full-end off-center];}
		}main.svelte-i67q8q {display:grid;grid-template-columns:subgrid;grid-column:full-start / full-end;flex-direction:column;width:100%;min-height:100%;}`};function Sa(t,e){H(e,!0),G(t,Ft);const[s,l]=F(),n=()=>q(c(L),"$user",s),p="/sounds/pop.mp3",r=we(void 0),a=new mt(window.fetch,se.PUBLIC_APP_HOST,r,"include");i(vt,a);const d=new ft(a);i(ht,d);const h=new $e(a);i(Le,h);const m=new Ue(a);i(ie,m);const o=new qe;i(pt,o),i(He,o);const g=new Vt(a,o.appDispatch);i(jt,g);const f=new gt(a,o.appDispatch);i(St,f);const S=new _t(a,o.appDispatch);i(yt,S);const x=new Te(a,o.appDispatch);i(Ae,x);const $=new Ye(a,o.appDispatch);i(Xe,$);const C=new Ze(a,o.appDispatch);i(Qe,C);const v=new De(a,o,o.appDispatch,r,C,se.PUBLIC_APP_HOST),w=new Je(a,o.appDispatch);i(et,w);const L=u(()=>m.user);re(()=>{n()&&(v.setUserId(n().id),v.setChatSoundUrl(p))}),i(Oe,v);const A=new Pe(a,o.appDispatch);i(Ne,A);const _=new Et(a,o.appDispatch);i(wt,_);const y=new at(a,o.appDispatch);i(st,y);const O=new We(a,o.appDispatch);i(Ge,O),i(tt,{open:V=>{location.href=V}});const N=new Me(a);i(Ke,N);const k=new rt(a);i(it,k);const z=new Be(a);i(Fe,z);const ne=new It(a,o.appDispatch);i(Ct,ne);const oe=u(()=>E.url.pathname.includes("/commit/")),ce=u(()=>E.url.pathname.includes("/login")),pe=u(()=>E.url.pathname.includes("/signup")),le=u(()=>E.url.pathname.includes("/finalize")),de=u(()=>E.url.pathname==="/loggedin"),M=u(()=>!c(oe)&&!c(ce)&&!c(pe)&&!c(le)&&!c(de));function ue(){return c(M)?E.route.id==="/(app)/profile"?[{label:"Profile",href:"/profile"}]:[]:[]}var K=Bt(),Y=Ie(K);Nt(Y,{});var U=b(Y,2),Z=B(U);{let V=u(()=>!c(M)),ve=u(ue);xe(Z,{get markOnly(){return c(V)},get breadcrumbs(){return c(ve)}})}var j=b(Z,2),fe=B(j);be(fe,()=>e.children??Ce),T(j);var he=b(j,2);Ut(he),T(U);var me=b(U,2);Ot(me,{}),D(t,K),W(),l()}export{Sa as component};
//# sourceMappingURL=2.BKecOfaB.js.map
